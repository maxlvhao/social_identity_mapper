<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Social Identity Mapping</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div id="app">
    <!-- Progress Bar -->
    <header id="progress-header" class="hidden">
      <div class="progress-bar">
        <div class="progress-fill" id="progress-fill"></div>
      </div>
      <div class="progress-steps">
        <span class="step" data-step="1">1. Identify Groups</span>
        <span class="step" data-step="2">2. Importance</span>
        <span class="step" data-step="3">3. Group Details</span>
        <span class="step" data-step="4">4. Position Groups</span>
        <span class="step" data-step="5">5. Connections</span>
        <span class="step" data-step="6">6. Complete</span>
      </div>
    </header>

    <!-- Step 0: Landing -->
    <section id="step-landing" class="step-screen active">
      <div class="step-content centered">
        <h1>Social Identity Mapping</h1>
        <p class="subtitle">A visual way to understand your social world and the groups you belong to.</p>

        <div class="session-info">
          <span>Session ID:</span>
          <code id="session-display">--</code>
        </div>

        <div class="intro-text">
          <p>In this activity, you will:</p>
          <ol>
            <li>Identify all the groups you belong to</li>
            <li>Rate how important each group is to you</li>
            <li>Add details about your relationship with each group</li>
            <li>Arrange the groups to show how similar or different they are</li>
            <li>Draw connections to show how easy it is to belong to multiple groups</li>
          </ol>
          <p>This typically takes 10-15 minutes. Your progress is saved automatically.</p>
        </div>

        <button id="start-btn" class="btn btn-primary btn-large">Begin Activity</button>
      </div>
    </section>

    <!-- Step 1: Identify Groups -->
    <section id="step-1" class="step-screen">
      <div class="step-content">
        <div class="step-header">
          <h2>Step 1: Identify Your Groups</h2>
          <p class="instruction">Think about <strong>all the groups that you belong to</strong>. These can take any form:</p>
        </div>

        <div class="examples-grid">
          <div class="example-card">
            <strong>Demographic/Opinion</strong>
            <span>feminist, Australian, vegetarian</span>
          </div>
          <div class="example-card">
            <strong>Leisure/Social</strong>
            <span>book club, gardening group, friend circle</span>
          </div>
          <div class="example-card">
            <strong>Community</strong>
            <span>church group, neighborhood association</span>
          </div>
          <div class="example-card">
            <strong>Sporting</strong>
            <span>rugby club, tennis team, gym buddies</span>
          </div>
          <div class="example-card">
            <strong>Work</strong>
            <span>sales team, department, company</span>
          </div>
          <div class="example-card">
            <strong>Professional</strong>
            <span>trade union, industry association</span>
          </div>
          <div class="example-card">
            <strong>Family</strong>
            <span>immediate family, extended family</span>
          </div>
          <div class="example-card">
            <strong>Educational</strong>
            <span>study group, alumni, classmates</span>
          </div>
        </div>

        <div class="input-section">
          <label for="new-group-input">Enter a group name and press Enter or click Add:</label>
          <div class="input-row">
            <input type="text" id="new-group-input" placeholder="e.g., Family, Book Club, Work Team...">
            <button id="add-group-btn" class="btn btn-primary">Add Group</button>
          </div>
        </div>

        <div class="groups-list-section">
          <h3>Your Groups (<span id="groups-count">0</span>)</h3>
          <ul id="groups-list" class="groups-list"></ul>
          <p class="hint" id="groups-hint">Add at least one group to continue.</p>
        </div>

        <div class="step-nav">
          <button id="step1-next" class="btn btn-primary btn-large" disabled>Next: Rate Importance</button>
        </div>
      </div>
    </section>

    <!-- Step 2: Importance Rating -->
    <section id="step-2" class="step-screen">
      <div class="step-content">
        <div class="step-header">
          <h2>Step 2: How Important is Each Group?</h2>
          <p class="instruction">For each group, indicate how important it is to you. <strong>Very important</strong> groups will appear larger and in blue. <strong>Moderately important</strong> groups will be medium-sized and gold. <strong>Less important</strong> groups will be smaller and gray.</p>
        </div>

        <div class="importance-legend">
          <div class="legend-item">
            <div class="legend-swatch importance-high"></div>
            <span>Very Important (Large, Blue)</span>
          </div>
          <div class="legend-item">
            <div class="legend-swatch importance-medium"></div>
            <span>Moderately Important (Medium, Gold)</span>
          </div>
          <div class="legend-item">
            <div class="legend-swatch importance-low"></div>
            <span>Less Important (Small, Gray)</span>
          </div>
        </div>

        <div id="importance-list" class="importance-list"></div>

        <p class="hint" id="importance-hint">Please rate all groups before continuing.</p>

        <div class="step-nav">
          <button id="step2-back" class="btn btn-secondary">Back</button>
          <button id="step2-next" class="btn btn-primary btn-large">Next: Add Details</button>
        </div>
      </div>
    </section>

    <!-- Step 3: Group Details -->
    <section id="step-3" class="step-screen">
      <div class="step-content">
        <div class="step-header">
          <h2>Step 3: Tell Us About Each Group</h2>
          <p class="instruction">For each group, we'll ask four questions. Click on a group to expand it and add your responses.</p>
        </div>

        <div class="details-info">
          <p>For each group, you'll answer four questions about your membership. Click a group to expand it and enter your responses. These values will appear in the corners of each group card on your final map.</p>
        </div>

        <div id="details-list" class="details-list"></div>

        <div class="step-nav">
          <button id="step3-back" class="btn btn-secondary">Back</button>
          <button id="step3-next" class="btn btn-primary btn-large">Next: Position Groups</button>
        </div>
      </div>
    </section>

    <!-- Step 4: Position Groups -->
    <section id="step-4" class="step-screen">
      <div class="step-content full-width">
        <div class="step-header compact">
          <h2>Step 4: How Different Are Your Groups?</h2>
          <p class="instruction">Drag your groups on the canvas. <strong>Place similar groups close together</strong> and <strong>different groups far apart</strong>. Consider: Do they do different things? Does it feel different being a member? Do they have different members?</p>
        </div>

        <div id="canvas-container-step4" class="canvas-container">
          <div id="groups-canvas-4" class="groups-canvas"></div>
        </div>

        <div class="step-nav">
          <button id="step4-back" class="btn btn-secondary">Back</button>
          <button id="step4-next" class="btn btn-primary btn-large">Lock Positions & Continue</button>
        </div>
      </div>
    </section>

    <!-- Step 5: Connections -->
    <section id="step-5" class="step-screen">
      <div class="step-content full-width">
        <div class="step-header compact">
          <h2>Step 5: How Easy Is It to Belong to Multiple Groups?</h2>
          <p class="instruction">Click and drag from one group to another to draw a connection. Then indicate how easy or difficult it is to be a member of both groups at the same time.</p>
        </div>

        <div class="connection-legend">
          <div class="legend-item">
            <svg width="60" height="20"><line x1="0" y1="10" x2="60" y2="10" class="conn-easy"/></svg>
            <span>Very Easy</span>
          </div>
          <div class="legend-item">
            <svg width="60" height="20"><path d="M0,10 Q15,0 30,10 Q45,20 60,10" class="conn-moderate" fill="none"/></svg>
            <span>Moderately Easy</span>
          </div>
          <div class="legend-item">
            <svg width="60" height="20"><path d="M0,10 L10,2 L20,18 L30,2 L40,18 L50,2 L60,10" class="conn-difficult" fill="none"/></svg>
            <span>Not Easy</span>
          </div>
        </div>

        <div id="canvas-container-step5" class="canvas-container">
          <svg id="connections-svg" class="connections-layer"></svg>
          <svg id="drawing-svg" class="drawing-layer"></svg>
          <div id="groups-canvas-5" class="groups-canvas locked"></div>
        </div>

        <p class="canvas-hint">Click and drag between groups to create connections. Click a connection line to change or remove it.</p>

        <div class="step-nav">
          <button id="step5-back" class="btn btn-secondary">Back (Unlock Positions)</button>
          <button id="step5-next" class="btn btn-primary btn-large">Finish</button>
        </div>
      </div>
    </section>

    <!-- Step 6: Complete -->
    <section id="step-6" class="step-screen">
      <div class="step-content centered">
        <div class="complete-icon">âœ“</div>
        <h2>Activity Complete!</h2>

        <div class="summary-box">
          <p>You mapped <strong id="final-groups">0</strong> groups with <strong id="final-connections">0</strong> connections.</p>
        </div>

        <div class="download-section">
          <p>Please download your data file and upload it to complete the survey.</p>
          <button id="download-btn" class="btn btn-primary btn-large">Download My Data</button>
        </div>

        <div class="preview-section">
          <h3>Your Social Identity Map</h3>
          <div id="final-canvas-container" class="canvas-container preview">
            <svg id="final-connections-svg" class="connections-layer"></svg>
            <div id="final-groups-canvas" class="groups-canvas locked"></div>
          </div>
        </div>

        <button id="back-to-edit" class="btn btn-secondary">Back to Edit</button>
      </div>
    </section>
  </div>

  <!-- Connection Type Modal -->
  <div id="connection-modal" class="modal hidden">
    <div class="modal-backdrop"></div>
    <div class="modal-content">
      <h3>Connection Type</h3>
      <p>How easy is it to be a member of both <strong id="modal-from"></strong> and <strong id="modal-to"></strong> at the same time?</p>

      <div class="connection-options">
        <button class="conn-option" data-type="easy">
          <svg width="60" height="20"><line x1="0" y1="10" x2="60" y2="10" class="conn-easy"/></svg>
          <span>Very Easy</span>
        </button>
        <button class="conn-option" data-type="moderate">
          <svg width="60" height="20"><path d="M0,10 Q15,0 30,10 Q45,20 60,10" class="conn-moderate" fill="none"/></svg>
          <span>Moderately Easy</span>
        </button>
        <button class="conn-option" data-type="difficult">
          <svg width="60" height="20"><path d="M0,10 L10,2 L20,18 L30,2 L40,18 L50,2 L60,10" class="conn-difficult" fill="none"/></svg>
          <span>Not Easy</span>
        </button>
      </div>

      <button id="remove-conn-btn" class="btn btn-danger hidden">Remove Connection</button>
      <button id="cancel-conn-btn" class="btn btn-secondary">Cancel</button>
    </div>
  </div>

  <script src="app.js"></script>
</body>
</html>
