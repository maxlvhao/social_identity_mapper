<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Social Identity Mapping</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <a href="/researcher.html" class="researcher-link" id="researcher-link">Researcher</a>
  <div id="app">
    <!-- Progress Bar -->
    <header id="progress-header" class="hidden">
      <div class="progress-bar">
        <div class="progress-fill" id="progress-fill"></div>
      </div>
      <div class="progress-steps">
        <span class="step" data-step="1">1. Identify Groups</span>
        <span class="step" data-step="2">2. Importance</span>
        <span class="step" data-step="3">3. Group Details</span>
        <span class="step" data-step="4">4. Position Groups</span>
        <span class="step" data-step="5">5. Connections</span>
        <span class="step" data-step="6">6. Complete</span>
      </div>
    </header>

    <!-- Step 0: Landing -->
    <section id="step-landing" class="step-screen active">
      <div class="step-content centered">
        <h1>Social Identity Mapping</h1>
        <p class="subtitle">A visual way to understand your social world and the groups you belong to.</p>

        <div class="session-info">
          <span>Session ID:</span>
          <code id="session-display">--</code>
        </div>

        <div class="intro-text">
          <p>In this activity, you will:</p>
          <ol>
            <li>Identify all the groups you belong to</li>
            <li>Rate how important each group is to you</li>
            <li>Add details about your relationship with each group</li>
            <li>Arrange the groups to show how similar or different they are</li>
            <li>Draw connections to show how easy it is to belong to multiple groups</li>
          </ol>
          <p>This typically takes 10-15 minutes. Your progress is saved automatically.</p>
        </div>

        <button id="start-btn" class="btn btn-primary btn-large">Begin Activity</button>
      </div>
    </section>

    <!-- Step 1: Identify Groups -->
    <section id="step-1" class="step-screen">
      <div class="step-content">
        <div class="step-header">
          <h2>Step 1: Identify Your Groups</h2>
          <p class="instruction">Think about <strong>all the groups that you belong to</strong>. These can take any form:</p>
        </div>

        <div class="examples-box">
          <p class="examples-intro">Examples:</p>
          <p class="examples-list">
            <strong>family</strong>, <strong>book club</strong>, <strong>church group</strong>, <strong>work team</strong>, <strong>gym buddies</strong>, <strong>study group</strong>, <strong>tennis club</strong>, <strong>neighborhood friends</strong>, <strong>alumni network</strong>, <strong>volunteer group</strong>
          </p>
          <p class="examples-categories">These could be family, social, community, sporting, work, professional, or any other type of group.</p>
        </div>

        <div class="input-section">
          <label for="new-group-input">Enter a group name and press Enter or click Add:</label>
          <div class="input-row">
            <input type="text" id="new-group-input" placeholder="e.g., Family, Book Club, Work Team...">
            <button id="add-group-btn" class="btn btn-primary">Add Group</button>
          </div>
        </div>

        <div class="groups-list-section">
          <h3>Your Groups (<span id="groups-count">0</span>)</h3>
          <ul id="groups-list" class="groups-list"></ul>
          <p class="hint" id="groups-hint">Add at least one group to continue.</p>
        </div>

        <div class="step-nav fixed-nav">
          <div></div>
          <button id="step1-next" class="btn btn-primary" disabled>Next</button>
        </div>
      </div>
    </section>

    <!-- Step 2: Importance Rating -->
    <section id="step-2" class="step-screen">
      <div class="step-content">
        <div class="step-header">
          <h2>Step 2: How Important is Each Group?</h2>
          <p class="instruction">For each group, indicate how important it is to you.</p>
        </div>

        <div id="importance-list" class="importance-list"></div>

        <p class="hint" id="importance-hint">Please rate all groups before continuing.</p>

        <div class="step-nav fixed-nav">
          <button id="step2-back" class="btn btn-secondary">Back</button>
          <button id="step2-next" class="btn btn-primary">Next</button>
        </div>
      </div>
    </section>

    <!-- Step 3: Group Details -->
    <section id="step-3" class="step-screen">
      <div class="step-content full-width">
        <div class="step-header">
          <h2>Step 3: Group Details</h2>
          <p class="instruction">For each group, answer the four questions below.</p>
        </div>

        <div class="details-questions">
          <div class="dq"><strong>Positivity:</strong> How positive do you feel about being a member of this group? (1 = not at all positive, 10 = very positive)</div>
          <div class="dq"><strong>Contact:</strong> In a typical month, how many days would you engage in activities related to this group? (0-30 days)</div>
          <div class="dq"><strong>Tenure:</strong> For how many years have you been a member of this group? (use decimals, e.g. 0.5 = 6 months)</div>
          <div class="dq"><strong>Representativeness:</strong> How well do you represent or exemplify what it means to be a member of this group? (1 = not at all, 10 = very well)</div>
        </div>

        <div class="details-table-container">
          <table class="details-table" id="details-table">
            <thead>
              <tr>
                <th>Group</th>
                <th>Positivity<br><span class="th-hint">(1-10)</span></th>
                <th>Contact<br><span class="th-hint">(days)</span></th>
                <th>Tenure<br><span class="th-hint">(years)</span></th>
                <th>Representativeness<br><span class="th-hint">(1-10)</span></th>
              </tr>
            </thead>
            <tbody id="details-tbody"></tbody>
          </table>
        </div>

        <div class="step-nav fixed-nav">
          <button id="step3-back" class="btn btn-secondary">Back</button>
          <button id="step3-next" class="btn btn-primary">Next</button>
        </div>
      </div>
    </section>

    <!-- Step 4: Position Groups -->
    <section id="step-4" class="step-screen">
      <div class="step-content full-width no-scroll">
        <div class="step-header compact">
          <h2>Step 4: Position</h2>
          <p class="instruction">Position your groups relative to each other. Drag groups on the canvas. Place <strong>similar groups close together</strong> and <strong>different groups far apart</strong>.</p>
        </div>

        <div id="canvas-container-step4" class="canvas-container flex-canvas">
          <div id="groups-canvas-4" class="groups-canvas"></div>
          <div id="drag-tutorial-4" class="tutorial-overlay">
            <div class="tutorial-content">
              <div class="tutorial-hand">ðŸ‘†</div>
              <p>Drag groups to position them</p>
            </div>
          </div>
        </div>

        <div class="step-nav fixed-nav">
          <button id="step4-back" class="btn btn-secondary">Back</button>
          <button id="step4-next" class="btn btn-primary">Next</button>
        </div>
      </div>
    </section>

    <!-- Step 5: Connections -->
    <section id="step-5" class="step-screen">
      <div class="step-content full-width no-scroll">
        <div class="step-header compact">
          <h2>Step 5: Belonging</h2>
          <p class="instruction">Drag from <strong>Me</strong> to a group to indicate how easy it is for you to belong to that group. Connect any two groups to indicate how easy it is to belong to both at the same time.</p>
        </div>

        <div id="canvas-container-step5" class="canvas-container flex-canvas">
          <svg id="connections-svg" class="connections-layer"></svg>
          <svg id="drawing-svg" class="drawing-layer"></svg>
          <div id="groups-canvas-5" class="groups-canvas locked"></div>
          <div id="drag-tutorial-5" class="tutorial-overlay">
            <div class="tutorial-content">
              <div class="tutorial-hand">ðŸ‘†</div>
              <p>Drag from one group to another to connect</p>
            </div>
          </div>
        </div>

        <div class="step-nav fixed-nav">
          <button id="step5-back" class="btn btn-secondary">Back</button>
          <button id="step5-next" class="btn btn-primary">Next</button>
        </div>
      </div>
    </section>

    <!-- Step 6: Complete -->
    <section id="step-6" class="step-screen">
      <div class="step-content no-scroll complete-screen">
        <div class="complete-header">
          <div class="complete-icon">âœ“</div>
          <h2>Activity Complete!</h2>
          <p>You mapped <strong id="final-groups">0</strong> groups with <strong id="final-connections">0</strong> connections.</p>
        </div>

        <div id="final-canvas-container" class="canvas-container final-preview">
          <svg id="final-connections-svg" class="connections-layer"></svg>
          <div id="final-groups-canvas" class="groups-canvas locked"></div>
        </div>

        <div class="qualtrics-reminder">
          <p><strong>Next step:</strong> After downloading your data file, return to Qualtrics and upload the file to complete the survey.</p>
        </div>

        <div class="step-nav fixed-nav">
          <button id="back-to-edit" class="btn btn-secondary">Back</button>
          <button id="download-btn" class="btn btn-primary">Download My Data</button>
        </div>
      </div>
    </section>
  </div>

  <!-- Connection Type Modal -->
  <div id="connection-modal" class="modal hidden">
    <div class="modal-backdrop"></div>
    <div class="modal-content compact-modal">
      <p class="modal-question" id="modal-question">How easy is it to be a member of both groups at the same time?</p>

      <div class="connection-options-row">
        <button class="conn-option-compact" data-type="easy">
          <svg width="40" height="12"><line x1="0" y1="6" x2="40" y2="6" class="conn-easy"/></svg>
          <span>Very Easy</span>
        </button>
        <button class="conn-option-compact" data-type="moderate">
          <svg width="40" height="12"><path d="M0,6 Q10,0 20,6 Q30,12 40,6" class="conn-moderate" fill="none"/></svg>
          <span>Moderate</span>
        </button>
        <button class="conn-option-compact" data-type="difficult">
          <svg width="40" height="12"><path d="M0,6 L8,1 L16,11 L24,1 L32,11 L40,6" class="conn-difficult" fill="none"/></svg>
          <span>Not Easy</span>
        </button>
      </div>

      <div class="modal-actions">
        <button id="remove-conn-btn" class="btn btn-danger btn-small hidden">Remove</button>
        <button id="cancel-conn-btn" class="btn btn-secondary btn-small">Cancel</button>
      </div>
    </div>
  </div>

  <script src="app.js"></script>
</body>
</html>
